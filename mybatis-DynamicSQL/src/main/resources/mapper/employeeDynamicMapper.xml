<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zy.mybatis.mapper.EmployeeDynamicMapper">
    <resultMap id="EmpByConditionIfList" type="com.zy.mybatis.pojo.Employee">
        <id column="id" property="id"/>
        <result column="last_name" property="lastName"/>
        <result column="gender" property="gender"/>
        <result column="email" property="email"/>
    </resultMap>
<!--    使用where标签去SQL多余第一个and-->
    <select id="getEmpByConditionIf" resultMap="EmpByConditionIfList">
        select *
        from tbl_employee
        <!-- where  1=1 -->
        <where>
            <if test="id!=null">
                id=#{id}
            </if>
            <!-- 使用转义字符代替特殊符号& -> &amp; 和 ; -> &quot;-->
            <if test="lastName!=null &amp;&amp; lastName.trim()!=&quot;&quot;">
                and last_name like concat('%',#{lastName},'%')
            </if>
            <!--动态SQL会对字符串与数字进行转换判断-->
            <if test="gender==0 or gender==1">
                and gender=#{gender}
            </if>
            <if test="email!=null&amp;&amp;email.trim()!=&quot;&quot;">
                and email=#{gender};
            </if>
        </where>
    </select>

<!--    使用trim标签去掉多余and or标签 and后置时情况 -->
    <select id="getEmpByConditionTrim" resultMap="EmpByConditionIfList">
        select *
        from tbl_employee
        <!--
             prefix="" 前缀  在所有条件之前加上的SQL前缀关键字
             prefixOverrides=""前缀覆盖：将字符串前面多余的and或者or去掉
             suffix="" 后缀  在所有条件之前加上的SQL前缀关键字
             suffixOverrides=""后缀覆盖：将字符串后面多余的and或者or去掉
        -->
        <trim prefix="where" suffixOverrides="and" >
            <if test="id!=null">
                id=#{id} and
            </if>
            <!-- 使用转义字符代替特殊符号& -> &amp; 和 ; -> &quot;-->
            <if test="lastName!=null &amp;&amp; lastName.trim()!=&quot;&quot;">
                last_name like concat('%',#{lastName},'%') and
            </if>
            <!--动态SQL会对字符串与数字进行转换判断-->
            <if test="gender==0 or gender==1">
                gender=#{gender} and
            </if>
            <if test="email!=null&amp;&amp;email.trim()!=&quot;&quot;">
                email=#{gender};
            </if>
        </trim>
    </select>

</mapper>